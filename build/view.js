const e="is-active",t={popover:null,backdrop:null,calendar:null,triggerElement:null,openedViaKeyboard:!1,cleanup:null},n=new WeakMap;let o=null;function r(e){o=e}function i(){return o}function c(e){return!0===n.get(e)}function a(e,t){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),r=window.innerWidth,i=window.innerHeight,c=10;let a=n.bottom+10,d=n.left+n.width/2-o.width/2;d<c&&(d=c),d+o.width>r-c&&(d=r-o.width-c),a+o.height>i-c&&(a=n.top-o.height-10),a<c&&(a=c),e.style.top=a+"px",e.style.left=d+"px"}function d(n,o,r){t.popover&&s();const i=n.getAttribute("data-event-content");if(!i)return;const d=document.getElementById(i);if(!d)return;const u=d.innerHTML;if(!u)return;const l=n.getAttribute("data-popover-style")||"",p=function(){const e=document.createElement("div");return e.className="gatherpress-calendar__backdrop",e.addEventListener("click",s),e}(),f=function(e,t){const n=document.createElement("div");return n.className="gatherpress-calendar__popover",n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.setAttribute("tabindex","-1"),t&&n.setAttribute("style",t),n.innerHTML=e,n.appendChild(function(){const e=document.createElement("button");return e.className="gatherpress-calendar__popover-close",e.innerHTML="&times;",e.setAttribute("aria-label","Close"),e.addEventListener("click",s),e}()),n}(u,l);document.body.appendChild(p),document.body.appendChild(f),a(f,n),function(t,n){setTimeout(function(){n.classList.add(e),t.classList.add(e)},10)}(f,p),t.popover=f,t.backdrop=p,t.calendar=o,t.triggerElement=n,t.openedViaKeyboard=r,f.focus();const v=function(e,n,o){return function(){t.popover&&c(o)&&a(e,n)}}(f,n,o);window.addEventListener("scroll",v,{passive:!0}),window.addEventListener("resize",v,{passive:!0}),t.cleanup=function(){window.removeEventListener("scroll",v),window.removeEventListener("resize",v)}}function s(){if(!t.popover)return;const n=t.triggerElement,o=t.openedViaKeyboard;t.cleanup&&t.cleanup();const r=t.popover,i=t.backdrop;!function(t,n,o){t.classList.remove(e),n&&n.classList.remove(e),setTimeout(o,200)}(r,i,function(){r&&r.parentNode&&r.parentNode.removeChild(r),i&&i.parentNode&&i.parentNode.removeChild(i),t.popover=null,t.backdrop=null,t.calendar=null,t.triggerElement=null,t.openedViaKeyboard=!1,t.cleanup=null,o&&n&&"function"==typeof n.focus&&n.focus()})}function u(e){"Escape"===e.key&&t.popover&&s()}function l(e){e.querySelectorAll(".gatherpress-calendar__event").forEach(function(t){t.hasAttribute("data-setup")||(t.setAttribute("data-setup","true"),t.setAttribute("role","button"),t.setAttribute("tabindex","0"),t.addEventListener("click",function(n){!function(e,t,n){c(n)&&(e.preventDefault(),e.stopPropagation(),d(t,n,!1))}(n,t,e)}),t.addEventListener("keydown",function(n){!function(e,t,n){c(n)&&("Enter"!==e.key&&" "!==e.key||(e.preventDefault(),d(t,n,!0)))}(n,t,e)}))})}!function(){function e(){const e=document.querySelectorAll(".gatherpress-calendar");e.length&&(function(e){"IntersectionObserver"in window?(r(new IntersectionObserver(function(e){e.forEach(function(e){const o=e.target,r=n.get(o),i=e.isIntersecting;n.set(o,i),i&&!r?l(o):!i&&r&&t.calendar===o&&s()})},{threshold:.1,rootMargin:"50px"})),e.forEach(function(e){const t=i();n.set(e,!1),t.observe(e)})):e.forEach(function(e){n.set(e,!0),l(e)})}(e),document.addEventListener("keydown",u))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("beforeunload",function(){s(),function(){const e=i();e&&(e.disconnect(),r(null))}()})}();