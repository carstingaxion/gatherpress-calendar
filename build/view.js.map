{"version":3,"file":"view.js","mappings":"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","sources":["webpack://block-gatherpress-calendar/./src/view.js"],"sourcesContent":["/**\n * GatherPress Calendar Block Frontend Script\n *\n * Progressive enhancement for the GatherPress Calendar block.\n * This script adds interactive popover functionality to event dots,\n * but the calendar remains fully functional without JavaScript.\n *\n * Progressive Enhancement Strategy:\n * - Without JS: Event dots are clickable <a> links that navigate to posts\n * - With JS: preventDefault on click, show popover overlay with post content\n * - Keyboard accessible: Enter/Space to open, Escape to close\n * - Focus management: Popover receives focus when opened\n * - Backdrop click: Clicking outside closes popover\n *\n * Why minimal JavaScript:\n * - Core functionality works without JS (links)\n * - Better performance on slow connections\n * - Improved accessibility baseline\n * - Graceful degradation for JS-disabled browsers\n *\n * @package GatherPressCalendar\n * @since 0.1.0\n */\n\n(function() {\n\t'use strict';\n\n\t/**\n\t * Active popover element reference.\n\t * Used to track which popover is currently open and close it when needed.\n\t *\n\t * @type {HTMLElement|null}\n\t */\n\tlet activePopover = null;\n\n\t/**\n\t * Active backdrop element reference.\n\t * The semi-transparent overlay behind the popover.\n\t *\n\t * @type {HTMLElement|null}\n\t */\n\tlet activeBackdrop = null;\n\n\t// Initialize when DOM is ready\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', init);\n\t} else {\n\t\tinit();\n\t}\n\n\t/**\n\t * Initialize popover functionality for all calendars on the page.\n\t *\n\t * Sets up event handlers for:\n\t * - Click/tap on event dots\n\t * - Keyboard interaction (Enter, Space, Escape)\n\t * - Backdrop clicks\n\t *\n\t * @since 0.1.0\n\t *\n\t * @return {void}\n\t */\n\tfunction init() {\n\t\tconst calendars = document.querySelectorAll('.gatherpress-calendar');\n\t\tif (!calendars.length) return;\n\n\t\tcalendars.forEach(setupCalendar);\n\n\t\t// Global escape key handler to close any open popover\n\t\tdocument.addEventListener('keydown', function(e) {\n\t\t\tif (e.key === 'Escape' && activePopover) {\n\t\t\t\tclosePopover();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Setup event handlers for a single calendar.\n\t *\n\t * Iterates through all event dots in the calendar and attaches:\n\t * - Click handler (prevents default navigation)\n\t * - Keyboard handler (Enter/Space keys)\n\t * - ARIA attributes for accessibility\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLElement} calendar - The calendar container element.\n\t *\n\t * @return {void}\n\t */\n\tfunction setupCalendar(calendar) {\n\t\tconst events = calendar.querySelectorAll('.gatherpress-calendar__event');\n\n\t\tevents.forEach(function(eventLink) {\n\t\t\t// Add ARIA attributes for screen readers\n\t\t\teventLink.setAttribute('role', 'button');\n\t\t\teventLink.setAttribute('tabindex', '0');\n\n\t\t\t// Click handler - prevent navigation, show popover\n\t\t\t// This is the progressive enhancement: without JS, the link works normally\n\t\t\teventLink.addEventListener('click', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tshowPopover(eventLink);\n\t\t\t});\n\n\t\t\t// Keyboard support for accessibility\n\t\t\t// Enter and Space keys should trigger the same action as click\n\t\t\teventLink.addEventListener('keydown', function(e) {\n\t\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tshowPopover(eventLink);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Show popover with event content.\n\t *\n\t * Creates and displays a popover overlay containing the event's inner blocks content.\n\t * The popover is positioned near the clicked event dot and includes:\n\t * - Post content from inner blocks (title, date, excerpt, etc.)\n\t * - Close button (Ã—)\n\t * - Custom styling from templateConfigStyle attribute\n\t *\n\t * Position calculation:\n\t * - Default: Below the event dot with 10px gap\n\t * - If no space below: Above the event dot\n\t * - Horizontally centered on the dot\n\t * - Constrained to viewport with 10px margins\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLAnchorElement} eventLink - The event dot link element that was clicked.\n\t *\n\t * @return {void}\n\t *\n\t * @example\n\t * // Event link structure:\n\t * // <a class=\"gatherpress-calendar__event\" data-popover-style=\"...\">\n\t * //   <div>Post Title</div>\n\t * //   <div>Post Date</div>\n\t * // </a>\n\t */\n\tfunction showPopover(eventLink) {\n\t\t// Close any existing popover first\n\t\tif (activePopover) closePopover();\n\n\t\t// Extract content and custom styling\n\t\tconst content = eventLink.innerHTML;\n\t\tconst customStyle = eventLink.getAttribute('data-popover-style') || '';\n\n\t\t// Create backdrop (semi-transparent overlay)\n\t\tconst backdrop = document.createElement('div');\n\t\tbackdrop.className = 'gatherpress-calendar__backdrop';\n\t\tbackdrop.addEventListener('click', closePopover);\n\t\tdocument.body.appendChild(backdrop);\n\n\t\t// Create popover container\n\t\tconst popover = document.createElement('div');\n\t\tpopover.className = 'gatherpress-calendar__popover';\n\t\tpopover.setAttribute('role', 'dialog');\n\t\tpopover.setAttribute('aria-modal', 'true');\n\t\tif (customStyle) {\n\t\t\tpopover.setAttribute('style', customStyle);\n\t\t}\n\n\t\t// Create close button\n\t\tconst closeBtn = document.createElement('button');\n\t\tcloseBtn.className = 'gatherpress-calendar__popover-close';\n\t\tcloseBtn.innerHTML = '&times;';\n\t\tcloseBtn.setAttribute('aria-label', 'Close');\n\t\tcloseBtn.addEventListener('click', closePopover);\n\n\t\t// Add content and close button to popover\n\t\tpopover.innerHTML = content;\n\t\tpopover.appendChild(closeBtn);\n\t\tdocument.body.appendChild(popover);\n\n\t\t// Position popover near the event dot\n\t\tpositionPopover(popover, eventLink);\n\n\t\t// Animate in (fade transition)\n\t\t// Small delay allows browser to calculate dimensions before transitioning\n\t\tsetTimeout(function() {\n\t\t\tbackdrop.classList.add('is-active');\n\t\t\tpopover.classList.add('is-active');\n\t\t}, 10);\n\n\t\t// Store references for cleanup\n\t\tactivePopover = popover;\n\t\tactiveBackdrop = backdrop;\n\t\t\n\t\t// Move focus to popover for keyboard navigation\n\t\tpopover.focus();\n\n\t\t// Setup position updates on scroll/resize\n\t\t// This keeps popover aligned with the dot even if page scrolls\n\t\tconst updatePos = function() {\n\t\t\tif (activePopover) positionPopover(popover, eventLink);\n\t\t};\n\t\twindow.addEventListener('scroll', updatePos);\n\t\twindow.addEventListener('resize', updatePos);\n\t\t\n\t\t// Store cleanup function for later\n\t\tpopover._cleanup = function() {\n\t\t\twindow.removeEventListener('scroll', updatePos);\n\t\t\twindow.removeEventListener('resize', updatePos);\n\t\t};\n\t}\n\n\t/**\n\t * Position popover near the event dot.\n\t *\n\t * Calculates optimal position for the popover based on:\n\t * - Event dot location\n\t * - Viewport dimensions\n\t * - Popover dimensions\n\t *\n\t * Positioning logic:\n\t * 1. Center horizontally on the dot\n\t * 2. Place below dot with 10px gap (default)\n\t * 3. If no space below, place above dot\n\t * 4. Constrain to viewport with 10px margins\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLElement} popover - The popover element to position.\n\t * @param {HTMLElement} eventLink - The event dot link element.\n\t *\n\t * @return {void}\n\t */\n\tfunction positionPopover(popover, eventLink) {\n\t\tconst linkRect = eventLink.getBoundingClientRect();\n\t\tconst popRect = popover.getBoundingClientRect();\n\t\tconst vw = window.innerWidth;\n\t\tconst vh = window.innerHeight;\n\t\tconst gap = 10;\n\n\t\t// Start with popover below the dot\n\t\tlet top = linkRect.bottom + gap;\n\t\t// Center horizontally on the dot\n\t\tlet left = linkRect.left + linkRect.width / 2 - popRect.width / 2;\n\n\t\t// Keep in viewport horizontally\n\t\tif (left < gap) left = gap;\n\t\tif (left + popRect.width > vw - gap) left = vw - popRect.width - gap;\n\n\t\t// Keep in viewport vertically\n\t\t// If popover would extend below viewport, show it above the dot instead\n\t\tif (top + popRect.height > vh - gap) {\n\t\t\ttop = linkRect.top - popRect.height - gap;\n\t\t}\n\t\t// If still not enough space, clamp to viewport top\n\t\tif (top < gap) top = gap;\n\n\t\t// Apply calculated position\n\t\tpopover.style.top = top + 'px';\n\t\tpopover.style.left = left + 'px';\n\t}\n\n\t/**\n\t * Close the active popover.\n\t *\n\t * Removes the popover and backdrop from the DOM with fade-out animation.\n\t * Cleans up event listeners to prevent memory leaks.\n\t *\n\t * Animation sequence:\n\t * 1. Remove 'is-active' class (triggers CSS fade-out)\n\t * 2. Wait 200ms for animation to complete\n\t * 3. Remove elements from DOM\n\t * 4. Clean up references\n\t *\n\t * @since 0.1.0\n\t *\n\t * @return {void}\n\t */\n\tfunction closePopover() {\n\t\tif (!activePopover) return;\n\n\t\t// Clean up event listeners\n\t\tif (activePopover._cleanup) activePopover._cleanup();\n\n\t\t// Start fade-out animation\n\t\tactivePopover.classList.remove('is-active');\n\t\tif (activeBackdrop) activeBackdrop.classList.remove('is-active');\n\n\t\t// Remove from DOM after animation completes\n\t\tsetTimeout(function() {\n\t\t\tif (activePopover && activePopover.parentNode) {\n\t\t\t\tactivePopover.parentNode.removeChild(activePopover);\n\t\t\t}\n\t\t\tif (activeBackdrop && activeBackdrop.parentNode) {\n\t\t\t\tactiveBackdrop.parentNode.removeChild(activeBackdrop);\n\t\t\t}\n\t\t\tactivePopover = null;\n\t\t\tactiveBackdrop = null;\n\t\t}, 200);\n\t}\n})();"],"names":["activePopover","activeBackdrop","document","readyState","addEventListener","init","calendars","querySelectorAll","length","forEach","setupCalendar","e","key","closePopover","calendar","events","eventLink","setAttribute","preventDefault","stopPropagation","showPopover","content","innerHTML","customStyle","getAttribute","backdrop","createElement","className","body","appendChild","popover","closeBtn","positionPopover","setTimeout","classList","add","focus","updatePos","window","_cleanup","removeEventListener","linkRect","getBoundingClientRect","popRect","vw","innerWidth","vh","innerHeight","gap","top","bottom","left","width","height","style","remove","parentNode","removeChild"],"ignoreList":[],"sourceRoot":""}