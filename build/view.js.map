{"version":3,"file":"view.js","mappings":"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","sources":["webpack://block-gatherpress-calendar/./src/view.js"],"sourcesContent":["/**\n * GatherPress Calendar Block Frontend Script\n *\n * This file contains JavaScript code that runs on the frontend of the site\n * for posts/pages containing the GatherPress Calendar block. It progressively\n * enhances the calendar by intercepting link clicks and showing popovers instead.\n *\n * Progressive Enhancement:\n * 1. Without JS: Dots are links that navigate to posts\n * 2. With JS: Dots show popovers with event details\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n *\n * @package GatherPressCalendar\n * @since 0.1.0\n */\n\n/**\n * Initialize the GatherPress Calendar block frontend functionality\n *\n * Sets up event listeners and interactive features for the calendar,\n * including popover creation and click/touch handling for event dots.\n * This is progressive enhancement - without JS, the dots work as regular links.\n *\n * @since 0.1.0\n *\n * @return {void}\n */\n( function initGatherPressCalendar() {\n\t'use strict';\n\n\t/**\n\t * Currently active popover element\n\t *\n\t * @type {HTMLElement|null}\n\t */\n\tlet activePopover = null;\n\n\t/**\n\t * Currently active backdrop element\n\t *\n\t * @type {HTMLElement|null}\n\t */\n\tlet activeBackdrop = null;\n\n\t/**\n\t * Wait for DOM to be ready\n\t */\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', init );\n\t} else {\n\t\tinit();\n\t}\n\n\t/**\n\t * Initialize calendar functionality\n\t *\n\t * @since 0.1.0\n\t *\n\t * @return {void}\n\t */\n\tfunction init() {\n\t\tconst calendars = document.querySelectorAll( '.gatherpress-calendar' );\n\n\t\tif ( ! calendars.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tcalendars.forEach( function ( calendar ) {\n\t\t\tsetupEventDotHandlers( calendar );\n\t\t} );\n\n\t\t// Close popover on escape key\n\t\tdocument.addEventListener( 'keydown', function ( e ) {\n\t\t\tif ( e.key === 'Escape' && activePopover ) {\n\t\t\t\tclosePopover();\n\t\t\t}\n\t\t} );\n\n\t\t// Log initialization\n\t\tif ( window.console && window.console.log ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(\n\t\t\t\t'GatherPress Calendar: Initialized ' +\n\t\t\t\t\tcalendars.length +\n\t\t\t\t\t' calendar(s) with progressive enhancement'\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Setup click/touch handlers for event dots in the calendar\n\t *\n\t * Progressively enhances the event dots (which are links) to show\n\t * popovers instead of navigating. If JS fails, links work normally.\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLElement} calendar - The calendar element.\n\t *\n\t * @return {void}\n\t */\n\tfunction setupEventDotHandlers( calendar ) {\n\t\tconst events = calendar.querySelectorAll(\n\t\t\t'.gatherpress-calendar__event'\n\t\t);\n\n\t\tevents.forEach( function ( eventLink ) {\n\t\t\t// Add accessibility attributes\n\t\t\teventLink.setAttribute( 'role', 'button' );\n\n\t\t\t// Handle click/touch - prevent default navigation and show popover\n\t\t\teventLink.addEventListener( 'click', function ( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tshowPopover( eventLink );\n\t\t\t} );\n\n\t\t\t// Handle keyboard accessibility\n\t\t\teventLink.addEventListener( 'keydown', function ( e ) {\n\t\t\t\tif ( e.key === 'Enter' || e.key === ' ' ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tshowPopover( eventLink );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\t/**\n\t * Show popover with event details\n\t *\n\t * Creates and positions a popover element containing the event's\n\t * inner block content.\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLElement} eventLink - The event link element that was clicked.\n\t *\n\t * @return {void}\n\t */\n\tfunction showPopover( eventLink ) {\n\t\t// Close any existing popover\n\t\tif ( activePopover ) {\n\t\t\tclosePopover();\n\t\t}\n\n\t\t// Get the event content\n\t\tconst eventContent = eventLink.innerHTML;\n\n\t\t// Create backdrop\n\t\tconst backdrop = document.createElement( 'div' );\n\t\tbackdrop.className = 'gatherpress-calendar__event-backdrop';\n\t\tbackdrop.addEventListener( 'click', closePopover );\n\t\tdocument.body.appendChild( backdrop );\n\n\t\t// Create popover\n\t\tconst popover = document.createElement( 'div' );\n\t\tpopover.className = 'gatherpress-calendar__event-popover';\n\t\tpopover.setAttribute( 'role', 'dialog' );\n\t\tpopover.setAttribute( 'aria-modal', 'true' );\n\n\t\t// Create close button\n\t\tconst closeButton = document.createElement( 'button' );\n\t\tcloseButton.className =\n\t\t\t'gatherpress-calendar__event-popover-close';\n\t\tcloseButton.innerHTML = '&times;';\n\t\tcloseButton.setAttribute( 'aria-label', 'Close' );\n\t\tcloseButton.addEventListener( 'click', closePopover );\n\n\t\t// Add content and close button to popover\n\t\tpopover.innerHTML = eventContent;\n\t\tpopover.appendChild( closeButton );\n\n\t\t// Add popover to body\n\t\tdocument.body.appendChild( popover );\n\n\t\t// Position popover\n\t\tpositionPopover( popover, eventLink );\n\n\t\t// Show with animation\n\t\tsetTimeout( function () {\n\t\t\tbackdrop.classList.add( 'is-active' );\n\t\t\tpopover.classList.add( 'is-active' );\n\t\t}, 10 );\n\n\t\t// Store references\n\t\tactivePopover = popover;\n\t\tactiveBackdrop = backdrop;\n\n\t\t// Focus the popover for accessibility\n\t\tpopover.focus();\n\n\t\t// Update position on scroll/resize\n\t\tconst updatePosition = function () {\n\t\t\tif ( activePopover ) {\n\t\t\t\tpositionPopover( popover, eventLink );\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener( 'scroll', updatePosition );\n\t\twindow.addEventListener( 'resize', updatePosition );\n\n\t\t// Store cleanup function\n\t\tpopover._cleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', updatePosition );\n\t\t\twindow.removeEventListener( 'resize', updatePosition );\n\t\t};\n\t}\n\n\t/**\n\t * Position popover relative to the event dot\n\t *\n\t * @since 0.1.0\n\t *\n\t * @param {HTMLElement} popover - The popover element.\n\t * @param {HTMLElement} eventLink - The event link element.\n\t *\n\t * @return {void}\n\t */\n\tfunction positionPopover( popover, eventLink ) {\n\t\tconst linkRect = eventLink.getBoundingClientRect();\n\t\tconst popoverRect = popover.getBoundingClientRect();\n\t\tconst viewportWidth = window.innerWidth;\n\t\tconst viewportHeight = window.innerHeight;\n\t\tconst spacing = 10;\n\n\t\tlet top = linkRect.bottom + spacing;\n\t\tlet left = linkRect.left + linkRect.width / 2 - popoverRect.width / 2;\n\n\t\t// Adjust horizontal position if popover goes off screen\n\t\tif ( left < spacing ) {\n\t\t\tleft = spacing;\n\t\t} else if ( left + popoverRect.width > viewportWidth - spacing ) {\n\t\t\tleft = viewportWidth - popoverRect.width - spacing;\n\t\t}\n\n\t\t// Adjust vertical position if popover goes below viewport\n\t\tif ( top + popoverRect.height > viewportHeight - spacing ) {\n\t\t\ttop = linkRect.top - popoverRect.height - spacing;\n\t\t}\n\n\t\t// Ensure popover doesn't go above viewport\n\t\tif ( top < spacing ) {\n\t\t\ttop = spacing;\n\t\t}\n\n\t\tpopover.style.top = top + 'px';\n\t\tpopover.style.left = left + 'px';\n\t}\n\n\t/**\n\t * Close the active popover\n\t *\n\t * @since 0.1.0\n\t *\n\t * @return {void}\n\t */\n\tfunction closePopover() {\n\t\tif ( ! activePopover ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Run cleanup\n\t\tif ( activePopover._cleanup ) {\n\t\t\tactivePopover._cleanup();\n\t\t}\n\n\t\t// Hide with animation\n\t\tactivePopover.classList.remove( 'is-active' );\n\t\tif ( activeBackdrop ) {\n\t\t\tactiveBackdrop.classList.remove( 'is-active' );\n\t\t}\n\n\t\t// Remove elements after animation\n\t\tsetTimeout( function () {\n\t\t\tif ( activePopover && activePopover.parentNode ) {\n\t\t\t\tactivePopover.parentNode.removeChild( activePopover );\n\t\t\t}\n\t\t\tif ( activeBackdrop && activeBackdrop.parentNode ) {\n\t\t\t\tactiveBackdrop.parentNode.removeChild( activeBackdrop );\n\t\t\t}\n\t\t\tactivePopover = null;\n\t\t\tactiveBackdrop = null;\n\t\t}, 200 );\n\t}\n} )();"],"names":["initGatherPressCalendar","activePopover","activeBackdrop","document","readyState","addEventListener","init","calendars","querySelectorAll","length","forEach","calendar","setupEventDotHandlers","e","key","closePopover","window","console","log","events","eventLink","setAttribute","preventDefault","stopPropagation","showPopover","eventContent","innerHTML","backdrop","createElement","className","body","appendChild","popover","closeButton","positionPopover","setTimeout","classList","add","focus","updatePosition","_cleanup","removeEventListener","linkRect","getBoundingClientRect","popoverRect","viewportWidth","innerWidth","viewportHeight","innerHeight","spacing","top","bottom","left","width","height","style","remove","parentNode","removeChild"],"ignoreList":[],"sourceRoot":""}