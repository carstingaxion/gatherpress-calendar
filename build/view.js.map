{"version":3,"file":"view.js","mappings":"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","sources":["webpack://block-gatherpress-calendar/./src/view.js"],"sourcesContent":["/**\n * Query Map Block Frontend Script\n *\n * Initializes OpenStreetMap via Leaflet and displays posts with geo data as clustered markers.\n * Depends on Leaflet and Leaflet MarkerCluster being loaded first via wp_enqueue_script.\n *\n * @package QueryMap\n * @since 0.1.0\n */\n\n(function() {\n\t'use strict';\n\n\t// Wait for DOM and Leaflet to be ready\n\tif ( typeof L === 'undefined' ) {\n\t\tconsole.error( 'Leaflet library not loaded' );\n\t\treturn;\n\t}\n\n\tif ( typeof L.markerClusterGroup === 'undefined' ) {\n\t\tconsole.error( 'Leaflet MarkerCluster library not loaded' );\n\t\treturn;\n\t}\n\n\tfunction initializeMaps() {\n\t\tconst mapContainers = document.querySelectorAll( '.gatherpress-query-map__map' );\n\t\t\n\t\tmapContainers.forEach( function( container ) {\n\t\t\tconst postsData = container.getAttribute( 'data-posts' );\n\t\t\tconst defaultZoom = parseInt( container.getAttribute( 'data-zoom' ) || '10', 10 );\n\t\t\t\n\t\t\tif ( ! postsData ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet posts;\n\t\t\ttry {\n\t\t\t\tposts = JSON.parse( postsData );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.error( 'Failed to parse posts data:', e );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif ( ! posts || posts.length === 0 ) {\n\t\t\t\tcontainer.innerHTML = '<p style=\"padding: 2rem; text-align: center; color: #666;\">No posts with geographic data found.</p>';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Initialize map centered on first post\n\t\t\tconst firstPost = posts[ 0 ];\n\t\t\tconst map = L.map( container ).setView(\n\t\t\t\t[ firstPost.lat, firstPost.lng ],\n\t\t\t\tdefaultZoom\n\t\t\t);\n\n\t\t\t// Add OpenStreetMap tiles\n\t\t\tL.tileLayer( 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n\t\t\t\tattribution: 'Â© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n\t\t\t\tmaxZoom: 19\n\t\t\t} ).addTo( map );\n\n\t\t\t// Create marker cluster group\n\t\t\tconst markersCluster = L.markerClusterGroup( {\n\t\t\t\tshowCoverageOnHover: false,\n\t\t\t\tmaxClusterRadius: 80,\n\t\t\t\tspiderfyOnMaxZoom: true,\n\t\t\t\tzoomToBoundsOnClick: true,\n\t\t\t\tdisableClusteringAtZoom: 18\n\t\t\t} );\n\n\t\t\t// Add markers for each post\n\t\t\tconst bounds = [];\n\t\t\tposts.forEach( function( post ) {\n\t\t\t\tconst marker = L.marker( [ post.lat, post.lng ] );\n\t\t\t\t\n\t\t\t\t// Bind popup with post content\n\t\t\t\tif ( post.content ) {\n\t\t\t\t\tmarker.bindPopup( post.content, {\n\t\t\t\t\t\tmaxWidth: 300,\n\t\t\t\t\t\tclassName: 'query-map-popup'\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tmarkersCluster.addLayer( marker );\n\t\t\t\tbounds.push( [ post.lat, post.lng ] );\n\t\t\t} );\n\n\t\t\t// Add cluster group to map\n\t\t\tmap.addLayer( markersCluster );\n\n\t\t\t// Fit map to show all markers if there are multiple\n\t\t\tif ( bounds.length > 1 ) {\n\t\t\t\tmap.fitBounds( bounds, { padding: [ 50, 50 ] } );\n\t\t\t} else if ( bounds.length === 1 ) {\n\t\t\t\tmap.setView( bounds[ 0 ], defaultZoom );\n\t\t\t}\n\t\t} );\n\t}\n\n\t// Initialize when DOM is ready\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initializeMaps );\n\t} else {\n\t\tinitializeMaps();\n\t}\n})();"],"names":["L","console","error","markerClusterGroup","initializeMaps","mapContainers","document","querySelectorAll","forEach","container","postsData","getAttribute","defaultZoom","parseInt","posts","JSON","parse","e","length","innerHTML","firstPost","map","setView","lat","lng","tileLayer","attribution","maxZoom","addTo","markersCluster","showCoverageOnHover","maxClusterRadius","spiderfyOnMaxZoom","zoomToBoundsOnClick","disableClusteringAtZoom","bounds","post","marker","content","bindPopup","maxWidth","className","addLayer","push","fitBounds","padding","readyState","addEventListener"],"ignoreList":[],"sourceRoot":""}